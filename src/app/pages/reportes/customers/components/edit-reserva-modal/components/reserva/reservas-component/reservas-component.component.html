<div class="container">
    <div class="row">
      <div class="col-md-6">
        <br />
        <label class="control-label">Periodo:</label>
        <br />
        &nbsp;
        <label>{{ fullFechaLlegada }} - {{ fullFechaSalida }} </label>
      </div>
      <div class="col-md-6">
        <br />
        <label class="control-label">Número de Noches:</label>
        <br />
        &nbsp;
        <label>{{ huesped.noches }} </label>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <br />
        <label class="control-label">ID de Reserva:</label>
        <br />
        &nbsp;
        <label>{{ huesped.folio }}</label>
      </div>
      <div class="col-md-6">
        <br />
        <label class="control-label">Habitacion / Cama:</label>
        <br />
        &nbsp;
        <label>{{ huesped.habitacion.replace("_"," ")  }} - {{huesped.numeroCuarto}}</label>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <br />
        <label class="control-label">Adultos / Personas:</label>
        <br />
        &nbsp;
        <label>{{ huesped.adultos }} </label>
      </div>
      <div class="col-md-6">
        <br />
        <label class="control-label">Niños:</label>
        <br />
        &nbsp;
        <label>{{ huesped.ninos }} </label>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <br />
        <label class="control-label">Creada:</label>
        <br />
        &nbsp;
        <label>{{ huesped.creada }} </label>
      </div>
      <div class="col-md-6">
        <label class="control-label">
          <br />
          Origen de Reserva:
        </label>
        <br />
        &nbsp;
       <label>{{ huesped.origen }}</label>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <br />
        <label class="font-weight-bold control-label"
          >Pago Via Pagina Web:</label
        >
        <br />
        &nbsp;
        <label>Paypal - 0 </label>
      </div>
      <div class="col-md-6">
        <br />
        <label class="font-weight-bold control-label"
          >Pagado Via Pagina Web:</label
        >
        <br />
        &nbsp;
        <label>$0.00 </label>
      </div>
    </div>
  </div>

  <br />
  <div style="background-color: #319dd7" class="modal-content sub-menu">
    <label
      class="h4"
      style="color: aliceblue; text-align: center; padding-top: 5px"
    >
      Estancia
    </label>
  </div>

  <div class="row col-md-12">
    <div class="col-sm-6">
      <br />
      <label class="control-label">A Pagar por Noche:</label>
      <br />
      <input
        disabled
        style="width: 150px"
        class="form-control"
        type="text"
        value="$ {{
          ((huesped.tarifa)).toLocaleString('es-MX')
        }}    MXN"
      />
    </div>

    <div class="col-sm-6">
      <br />
      <label class="control-label">A Pagar por Estancia:</label>
      <br />
      <input
        disabled
        style="width: 150px"
        class="form-control"
        type="text"
        value="$ {{
          (huesped.tarifa * huesped.noches).toLocaleString('es-MX')
        }}    MXN"
      />
    </div>
  </div>

  <br />
  <div style="background-color: #319dd7" class="modal-content">
    <label
      class="h4"
      style="color: aliceblue; text-align: center; padding-top: 5px"
    >
      Recordatorio de Deposito
    </label>
  </div>
  <form [formGroup]="formGroupPromesa">
  <div class="row col-md-12">
      <div class="col-sm-6">
        <br />
        <label class="control-label">Cantidad Acordada:</label>
        <br />
        <input
          formControlName="promesaPago"
          style="width: 150px"
          class="form-control"
          type="number"
          placeholder="$ 0.00    MXN"
          [class.is-invalid]="isControlInvalid('promesaPago')"
          [class.is-valid]="isControlValid('promesaPago')"
        />
      </div>
  
        <div class="col-sm-6">
          <br>
          <label style="color:#00506a; font-weight: bold;" class="form-label">Selecciona Fecha Final</label>
          <div class="form-group" >
            <div class="input-group">
              <input  
              formControlName="fechaPromesaPago"  
              hidden 
              class="form-control"  
              placeholder="yyyy-mm-dd" 
              name="dp"  
              [startDate]="fromDate!"
              ngbDatepicker
              (dateSelect)="fechaSeleccionadaFinal($event)" 
              [minDate]=today
              #f="ngbDatepicker">
  
              <input         
              [disabled]="huesped.estatus=='Reserva Cancelada'||huesped.estatus=='No Show'"
              class="form-control"  placeholder="yyyy-mm-dd" name="dpnotHidden" #ff  [value]="fechaFinalBloqueo" >
  
              <div class="input-group-append">
                <button class="btn btn-primary" (click)="f.toggle()" type="button">
                  <i class="fa fa-calendar icon"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
  </div>
</form>
<div class="row">
  <div
    style="
      display: flex;
      justify-content: space-evenly;
      flex-direction: row;
    "
    class="col-md-6"
  >
    <button 
    (click)="guardarPromesa()"
    class="btn btn-success btn-block">Guardar Promesa</button>
  </div>
  <div class="col-md-6">
    <button 
    (click)="togglePromesas()"
    class="btn btn-danger btn-block">
    Ver Promesas
    </button>
  </div>
</div>


<br>

<ng-container *ngIf="promesasDisplay">
  
  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>

      <!-- Checkbox Column -->
      <ng-container matColumnDef="select">
        <th class="header-align-right" mat-header-cell *matHeaderCellDef>
          <td class="header-align-right" mat-cell *matCellDef="let row">
          <button 
          [disabled]="row.Aplicado"
          (click)="eliminarPromesa(row._id)"
          class="btn btn-danger">
              x
          </button>
        </td>
      </ng-container>

      <!-- Fecha Column -->
      <ng-container matColumnDef="_id">
        <th mat-header-cell hidden *matHeaderCellDef mat-sort-header> _id </th>
        <td mat-cell hidden *matCellDef="let row"> {{row._id}} </td>
      </ng-container>

      <!-- Color Column -->
      <ng-container matColumnDef="Color">
        <th mat-header-cell hidden *matHeaderCellDef mat-sort-header> Color </th>
        <td mat-cell hidden *matCellDef="let row"> {{row.Color}} </td>
      </ng-container>

      <!-- ColorAplicado Column -->
      <ng-container matColumnDef="ColorAplicado">
        <th mat-header-cell hidden *matHeaderCellDef mat-sort-header> ColorAplicado </th>
        <td mat-cell hidden *matCellDef="let row"> {{row.ColorAplicado}} </td>
      </ng-container> 

      <!-- Fecha Column -->
      <ng-container matColumnDef="Fecha">
        <th mat-header-cell  *matHeaderCellDef mat-sort-header> Fecha </th>
        <td  mat-cell *matCellDef="let row"> {{row.Fecha}} </td>
      </ng-container>

      <!-- Cantidad Column -->
      <ng-container matColumnDef="Cantidad">
        <th mat-header-cell  *matHeaderCellDef mat-sort-header> Cantidad </th>
        <td mat-cell *matCellDef="let row">$ {{row.Cantidad.toLocaleString("es-MX")}}.00 </td>
      </ng-container>

      <ng-container hidden matColumnDef="Estatus">
        <th mat-header-cell  *matHeaderCellDef mat-sort-header> Estatus </th>
        <td style="color: white; font-weight: bold;" 
        [style.background]="row.Color"
        at-cell *matCellDef="let row"> {{row.Expirado }} </td>
      </ng-container>
      <!-- [ngStyle]="{'background-color': row.Expirado ? '#f7347a' : '#00c688' }"  -->

      <!-- Aplicar PAgo Column -->
      <ng-container hidden matColumnDef="Accion">
        <th mat-header-cell  *matHeaderCellDef mat-sort-header> Accion </th>
        <td mat-cell  *matCellDef="let row"> 
          <ng-container *ngIf="row.Aplicado==false">
            <button 
              (click)="preguntasPrevias(row);estatusAplicado(row)" 
              style="background-color: #FBCF67;"
              class="btn btn-info">
                <i  class="fa fa-check" aria-hidden="false"></i>
            </button>
            </ng-container>
            <ng-container *ngIf="row.Aplicado">
              <button 
              (click)="preguntasPrevias(row);estatusAplicado(row)" 
              style="background-color: #319DD7;"
              class="btn btn-info">
                <i class="fa fa-eye" aria-hidden="true"></i>
            </button>
          </ng-container>          
         </td>
      </ng-container>

  
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row (click)="clickedRow.add(row);" *matRowDef="let row; columns: displayedColumns;"></tr>
  
      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No se encontraron datos</td>
      </tr>

    </table>
  
    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Pagina"></mat-paginator>
  </div>
</ng-container>


  <div style="background-color: #319dd7" class="modal-content sub-menu">
    <label
      class="h4"
      style="color: aliceblue; text-align: center; padding-top: 5px"
    >
      SERVICIOS ADICIONALES
    </label>
  </div>

<br>
<form [formGroup]="serviciosAdicionaledForm">


  <!-- <div class="row">
    <div style="text-align: center; justify-content:space-evenly;" class="col-md-12">
      <section formControlName="adicional" class="example-section">
        <ng-container *ngFor="let adicional of adicionalArray">
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <mat-checkbox 
          [disabled]="huesped.estatus=='Reserva Cancelada'||huesped.estatus=='No Show'"
          (change)="servicioAdicional($event,adicional.Adicional,adicional.Descripcion)"
          style="color:#00506a; font-weight: bold;">{{adicional.Descripcion}} </mat-checkbox>
        </ng-container>
      </section>      
      <br>
    </div>
  </div> -->
<br>
  <div style="background-color: #319dd7" class="modal-content sub-menu">
    <label
      class="h4"
      style="color: aliceblue; text-align: center; padding-top: 5px"
    >
      NOTAS DEL CLIENTE
    </label>
  </div>
<br>
  <div class="row">
    <div style="text-align: center;" class="col-md-12">
      <textarea formControlName="notas" style="border: 2px solid rgb(177, 177, 177)" class="form-control">           - NOTAS EXTRAS DEL CLIENTE</textarea>
    </div>
  </div>

  <br />
  <div class="row">
    <!-- <div
      style="
        display: flex;
        justify-content: space-evenly;
        flex-direction: row;
      "
      class="col-md-6"
    >
      <button 
      (click)="formReset()"
      class="btn btn-secondary btn-block">Cancelar</button>
    </div> -->
    <div class="col-md-12">
      <button 
      (click)="guardarAdicionales()"
      class="btn btn-success btn-block">
        Actualizar y Guardar
      </button>
    </div>
  </div>
  <br>
</form>

  <div [style]="changeStyleHidden">
    <div
      style="
        border-radius: 5px;
        background-color: #162f58;
        display: flex;
        justify-content: space-evenly;
        flex-direction: row;
      "
      class="col-md-12 container"
    >
      <label style="color: aliceblue"> Estado de Reserva / Folio </label>
    </div>
    <br />

    <div class="row">
      <div class="col-lg-12">
        <button
          class="btn btn-primary btn-block"
          type="submit"
          name="estatus"
          (click)="setEstatus(1)"
        >
          eFirma de Registro
        </button>
      </div>
      <div class="col-lg-12">
        <button
          class="btn btn-warning btn-block"
          type="submit"
          name="estatus"
          (click)="setEstatus(3)"
        >
          Realizar un Pago
        </button>
      </div>
      <div class="col-lg-12">
        <button
          class="btn btn-danger btn-block"
          type="submit"
          (click)="setEstatus(6)"
        >
          Realiza Check-Out
        </button>
      </div>
      <div class="f col-lg-12">
        <button
          class="btn btn-secondary btn-block"
          type="submit"
          value="7"
          (click)="setEstatus(7)"
        >
          Modifica Reserva
        </button>
      </div>
    </div>
  </div>  
  


  <ng-container *ngIf="isLoading">
    <app-loader-spinner></app-loader-spinner>
  </ng-container>

  <ng-template #pregunta let-modal>
    <div class="modal-header">
      <h4 class="modal-title">Realizar Deposito</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
<div class="modal-body">
    <button type="button" class="btn btn-success col-md-12" (click)="modal.close(1);next.emit();">Agregar Pago Completo a la Cuenta</button>
<p></p>
    <ng-container *ngIf="pagoManual">
      <form [formGroup]="thirdForm">
        <input 
        class="form-control col-md-6"
        formControlName='pagoManualInput'
        > 
        <button class="btn btn-info col-md-6" (click)="modal.close(2);next.emit();">Aceptar
        </button>
        <br>
      </form>
    </ng-container>
    <p></p>

  <button type="button" class="btn btn-secondary col-md-12" (click)="muestraInput()">Agregar Pago Parcial</button>
  <p></p>
  <div class="col-sm-12">
    <form [formGroup]="forthForm">
      <mat-form-field appearance="fill">
        <mat-label>Forma de Pago</mat-label>
        <mat-select 
        style="font-weight: bold;"
        formControlName="pago"
        #pago>
            <mat-option *ngFor="let pago of formasDePago" value={{pago}}>{{pago}}</mat-option>
        </mat-select>
    </mat-form-field>
    </form>
    
</div>
</div>
<p></p>

     
    <div class="modal-footer">
      <button type="button" class="btn btn-warning col-md-12" (click)="modal.close(3)">Cerrar</button>
    </div>
  </ng-template>